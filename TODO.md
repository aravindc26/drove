### TODO

- Check if capacity is updated correctly when goroutine shuts down
